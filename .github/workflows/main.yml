name: Build Flet App

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # ... 其他步骤 (如 checkout, setup-python) ...

      - name: Install Flutter SDK
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.19.5' # 指定一个稳定版本

      - name: Upgrade Flet and build dependencies
        run: |
          pip install flet --upgrade
          # 可选：如果问题依旧，可以尝试强制重新安装 flet-cli
          # pip install --force-reinstall flet-cli

      - name: Build APK
        run: |
          flet build apk --include-packages subprocess,platform,pathlib,requests,tqdm
